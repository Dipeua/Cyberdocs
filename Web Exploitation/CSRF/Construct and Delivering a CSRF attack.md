Le moyen le plus simple de créer un exploit CSRF est d'utiliser le [générateur de preuve de concept CSRF](https://portswigger.net/burp/documentation/desktop/tools/engagement-tools/generate-csrf-poc) intégré à Burp Suite Professional :

- Sélectionnez une demande n’importe où dans Burp Suite Professional que vous souhaitez tester ou exploiter.
- Dans le menu contextuel du clic droit, sélectionnez `Engagement Tools` -> `Genered CSRF PoC`
- Burp Suite générera du code HTML qui déclenchera la requête sélectionnée (moins les cookies, qui seront ajoutés automatiquement par le navigateur de la victime).
- Vous pouvez modifier diverses options du générateur de preuve de concept CSRF pour affiner certains aspects de l'attaque. Cette opération peut s'avérer nécessaire dans certaines situations inhabituelles, notamment pour gérer les caractéristiques particulières des requêtes.
- Copiez le code HTML généré dans une page Web, affichez-le dans un navigateur connecté au site Web vulnérable et testez si la demande prévue est émise avec succès et si l'action souhaitée se produit.


## Livrer un exploit CSRF

Les mécanismes de diffusion des attaques par falsification de requêtes intersites (XSS) sont globalement les mêmes que ceux des attaques XSS réfléchies. 

- Généralement, l'attaquant place le code HTML malveillant sur un site web qu'il contrôle, puis incite les victimes à le visiter. Il peut y parvenir en fournissant à l'utilisateur un lien vers le site web, par e-mail ou sur les réseaux sociaux. 

- Ou, si l'attaque est placée sur un site web populaire (par exemple, dans un commentaire d'utilisateur), il peut simplement attendre que l'utilisateur le visite.

Notez que certains exploits CSRF simples utilisent la méthode GET et peuvent être entièrement autonomes avec une seule URL sur le site web vulnérable. Dans ce cas, l'attaquant peut se passer d'un site externe et fournir directement aux victimes une URL malveillante sur le domaine vulnérable. 

Dans l'exemple précédent, si la demande de changement d'adresse e-mail peut être effectuée avec la méthode GET, une attaque autonome se présenterait comme suit :

```html
<img src="https://vulnerable-website.com/email/change?email=pwned@evil-user.net">
```
