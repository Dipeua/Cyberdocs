## Défenses courantes contre le CSRF

De nos jours, pour détecter et exploiter avec succès les vulnérabilités CSRF, il faut souvent contourner les mesures anti-CSRF déployées par le site web ciblé, le navigateur de la victime, ou les deux. Les défenses les plus courantes sont les suivantes :

- **Jetons CSRF** : un jeton CSRF est une valeur unique, secrète et imprévisible, générée par l'application côté serveur et partagée avec le client. Lorsqu'il tente d'effectuer une action sensible, comme l'envoi d'un formulaire, le client doit inclure le jeton CSRF correct dans sa requête. Il est donc très difficile pour un attaquant de générer une requête valide au nom de la victime.
    
- **Cookies SameSite** : SameSite est un mécanisme de sécurité du navigateur qui détermine si les cookies d'un site web sont inclus dans les requêtes provenant d'autres sites web. Les requêtes d'actions sensibles nécessitant généralement un cookie de session authentifié, les restrictions SameSite appropriées peuvent empêcher un attaquant de déclencher ces actions entre sites. Depuis 2021, Chrome applique `Lax`les restrictions SameSite par défaut. Comme il s'agit de la norme proposée, nous nous attendons à ce que d'autres navigateurs majeurs adoptent ce comportement à l'avenir.
    
- **Validation basée sur le référent** : certaines applications utilisent l'en-tête HTTP Referer pour se protéger des attaques CSRF, généralement en vérifiant que la requête provient bien de leur propre domaine. Cette méthode est généralement moins efficace que la validation par jeton CSRF.