Le XSS basé sur le DOM (également appelé DOM XSS) survient lorsqu'une application contient du JavaScript côté client qui traite les données d'une source non fiable de manière dangereuse, généralement en réécrivant les données dans le DOM.

Dans l'exemple suivant, une application utilise du JavaScript pour lire la valeur d'un champ de saisie et écrire cette valeur dans un élément du code HTML :

```js
var search = document.getElementById('search').value; 
var results = document.getElementById('results'); 

results.innerHTML = 'You searched for: ' + search;
```

Si l'attaquant peut contrôler la valeur du champ de saisie, il peut facilement construire une valeur malveillante qui provoque l'exécution de son propre script :

```html
You searched for: <img src=1 onerror='/* Bad stuff here... */'>
```

---

Les vulnérabilités basées sur le DOM surviennent lorsqu'un site web contient du JavaScript qui prend une valeur contrôlable par l'attaquant, appelée `source`, et la transmet à une fonction dangereuse, appelée `récepteur ou puit (sink)`.

### Sources communes

Voici quelques sources typiques qui peuvent être utilisées pour exploiter diverses vulnérabilités de flux contaminé :

```
document.URL
document.documentURI
document.URLUnencoded
document.baseURI
location
document.cookie
document.referrer
window.name
history.pushState
history.replaceState
localStorage
sessionStorage
IndexedDB (mozIndexedDB, webkitIndexedDB, msIndexedDB)
Database
```