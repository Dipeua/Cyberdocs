# Cross-site scripting (XSS)

Le cross-site scripting (XSS) est une vulnérabilité de sécurité web qui permet à un attaquant de compromettre les interactions des utilisateurs avec une application vulnérable.

Permettent généralement à un attaquant de se faire passer pour une victime, d'effectuer toutes les actions que celle-ci peut effectuer et d'accéder à ses données.

Si la victime dispose d'un accès privilégié à l'application, l'attaquant peut prendre le contrôle total de toutes les fonctionnalités et données de l'application.

#### Comment fonctionne XSS ?

> Cela consiste à manipuler un site web vulnérable afin qu'il renvoie du code JavaScript malveillant aux utilisateurs. Lorsque le code malveillant s'exécute dans le navigateur de la victime, l'attaquant peut compromettre totalement son interaction avec l'application.

#### Preuve de concept XSS

Vous pouvez confirmer la plupart des vulnérabilités XSS en injectant une charge utile qui force votre navigateur à exécuter du code JavaScript arbitraire. comme `print()` ou `alert()`


## Les types d’attaques XSS ?

- [XSS Reflected](./XSS%20Reflected): où le script malveillant provient de la requête HTTP actuelle.
- [XSS Stored](./XSS%20Stored): où le script malveillant provient de la base de données du site Web.
- [XSS DOM Based](./XSS%20DOM%20Based): où la vulnérabilité existe dans le code côté client plutôt que dans le code côté serveur.

[Cross-site scripting (XSS) cheat sheet](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet)

## À quoi peut servir XSS ?

Un attaquant qui exploite une vulnérabilité de script intersite est généralement capable de :

- Se faire passer pour l’utilisateur victime.
- Effectuer toute action que l’utilisateur est en mesure d’effectuer.
- Lisez toutes les données auxquelles l’utilisateur peut accéder.
- Capturez les informations de connexion de l'utilisateur.
- Effectuer une défiguration virtuelle du site Web.
- Injectez la fonctionnalité du cheval de Troie dans le site Web.

> L'impact réel d'une attaque XSS dépend généralement de la nature de l'application, de ses fonctionnalités et de ses données, ainsi que du statut de l'utilisateur compromis.

## Comment trouver et tester les vulnérabilités XSS

- Tester manuellement les XSS réfléchis et stockés implique généralement de soumettre une entrée unique et simple (comme une courte chaîne alphanumérique) à chaque point d'entrée de l'application, d'identifier chaque emplacement où l'entrée soumise est renvoyée dans les réponses HTTP et de tester chaque emplacement individuellement afin de déterminer si une entrée correctement conçue peut être utilisée pour exécuter du code JavaScript arbitraire.

- Le test manuel des XSS DOM provenant de paramètres d'URL implique un processus similaire : il suffit de placer une entrée unique et simple dans le paramètre, d'utiliser les outils de développement du navigateur pour rechercher cette entrée dans le DOM et de tester chaque emplacement afin de déterminer s'il est exploitable.


## Politique de sécurité du contenu

[La politique de sécurité du contenu (CSP)](./Content%20Security%20Policy%20(CSP)) est un mécanisme de navigateur visant à atténuer l'impact des scripts intersites et d'autres vulnérabilités. Si une application utilisant une CSP présente un comportement de type XSS, elle peut entraver ou empêcher l'exploitation de la vulnérabilité. Souvent, la CSP peut être contournée pour permettre l'exploitation de la vulnérabilité sous-jacente.