# Vulnérabilités dans la connexion par mot de passe 

## Attaques par force brute

Lors de l'audit, vérifiez si le site Web divulgue publiquement les noms d’utilisateurs potentiels. Par exemple:
    
- Pouvez-vous accéder aux profils utilisateur sans vous connecter ?

- Vous devez également vérifier les réponses HTTP pour voir si des adresses e-mail sont divulguées.

### Énumération du nom d'utilisateur

Lorsque vous essayez de forcer brutalement une page de connexion, vous devez prêter une attention particulière aux différences dans : 

- `Codes d'état`  : lors d'une attaque par force brute, le code d'état HTTP renvoyé est probablement le même pour la grande majorité des suppositions, car la plupart d'entre elles seront fausses. Si une supposition renvoie un code d'état différent, c'est une forte indication que le nom d'utilisateur était correct. 

- `Messages d'erreur`  : Parfois, le message d'erreur renvoyé est différent selon que le nom d'utilisateur ET le mot de passe sont incorrects ou que seul le mot de passe était incorrect.

- `Délais de réponse`: si la plupart des demandes ont été traitées avec un temps de réponse similaire, celles qui s'en écartent suggèrent que quelque chose de différent se passait en coulisses. C'est une autre indication que le nom d'utilisateur deviné pourrait être correct.

### Failles dans la protection contre la force brute

- `Verrouillage du compte` auquel l'utilisateur distant tente d'accéder s'il effectue trop de tentatives de connexion infructueuses

- Limitation du débit utilisateur (`Bloquer l'adresse IP` de l'utilisateur distant s'il effectue trop de tentatives de connexion successives)

> Exemple: Un attaquant peut exploiter une faille où le compteur de tentatives infructueuses se réinitialise après une connexion réussie, en alternant ses tentatives de force brute avec des connexions valides pour contourner la protection.

**Contourner le Verrouillage du compte**

1. Établissez une liste de noms d’utilisateurs susceptibles d’être valides. Cela peut se faire via une énumération de noms d’utilisateur ou simplement sur la base d’une liste de noms d’utilisateur courants.

2. Choisissez une très petite liste de mots de passe que vous pensez qu'au moins un utilisateur est susceptible de posséder. 

> Surtout, le nombre de mots de passe que vous sélectionnez ne doit pas dépasser le nombre de tentatives de connexion autorisées. Par exemple, si vous avez déterminé que la limite est de 3 tentatives, vous devez choisir un maximum de 3 tentatives de mot de passe.

3. À l'aide d'un outil tel que Burp Intruder, essayez chacun des mots de passe sélectionnés avec chacun des noms d'utilisateur candidats. De cette façon, vous pouvez tenter de forcer brutalement chaque compte sans déclencher le verrouillage du compte. Vous n’avez besoin que d’un seul utilisateur pour utiliser l’un des trois mots de passe afin de compromettre un compte

## Exploiter HTTP basic authentication



### Brute force login page with ffuf

FUZZ valid username on signup page

```sh
ffuf -w /opt/secLists/Usernames/Names/names.txt -X POST -d "username=FUZZ&email=x&password=x&cpassword=x" -H "Content-Type: application/x-www-form-urlencoded" -u http://10.10.167.142/customers/signup -mr "username already exists"
```

L'argument `-mr` est le texte de la page que nous recherchons pour valider que nous avons trouvé un nom d'utilisateur valide.

Une attaque force brute

```sh
ffuf -w valid_usernames.txt:W1,/opt/secLists/Passwords/Common-Credentials/10-million-password-list-top-100.txt:W2 -X POST -d "username=W1&password=W2" -H "Content-Type: application/x-www-form-urlencoded" -u http://10.10.167.142/customers/login -fc 200
```

L'argument `-fc` pour rechercher un code d'état HTTP autre que 200.