PATH sous Linux est une variable d'environnement qui indique au système d'exploitation où rechercher les exécutables.

Si un dossier pour lequel votre utilisateur dispose d'une autorisation d'écriture se trouve dans le chemin, vous pourriez potentiellement détourner une application pour exécuter un script.

Les questions a ce poser avant d'exploiter cette vulnérabilité :

1. Quels dossiers se trouvent sous $PATH ?
2. Votre utilisateur actuel dispose-t-il de privilèges d'écriture pour l'un de ces dossiers ?
3. Pouvez-vous modifier $PATH ?
4. Existe-t-il un script/une application que vous pouvez démarrer et qui sera affecté par cette vulnérabilité ?

```sh
find / -writable 2>/dev/null | cut -d "/" -f 2,3 | grep -v proc | sort -u
```

```sh
export PATH=/[dir]:$PATH
```


--- 

**Comprendre le SUID, SGID, Sticky Bit**

| Permission | Sur les fichiers                                                                    | Sur les dossier                                                               |
| ---------- | ----------------------------------------------------------------------------------- | ----------------------------------------------------------------------------- |
| SUID       | L'utilisateur exécute le fichier avec les les privilèges du propriétaire du fichier |                                                                               |
| SGID       | L'utilisateur exécute le fichier avec l'autorisation du propriétaire _du groupe_ .  | Le fichier créé dans le répertoire obtient le même propriétaire de groupe.    |
| Sticky Bit |                                                                                     | Les utilisateurs ne peuvent pas supprimer les fichiers d'autres utilisateurs. |

> Lorsque un binaire est exécuté sans chemin complet (chemin relative) et que ce binaire s'exécute avec les privilèges de l'utilisateur root, nous pouvons manipuler notre chemin pour obtenir un shell root.
> 
> Cela en creant le meme binaire contenant un script malveillant et renommer la variable $PATH pour modifier les chemins d'executable.


```sh
echo $PATH
```

```sh
echo '/bin/sh' > binary
echo 777 binary
export PATH=/tmp:$PATH
```

