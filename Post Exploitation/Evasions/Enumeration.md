# Enumeration

## Host Security

Enumérer les logiciels AV

```sh
wmic /namespace:\\root\securitycenter2 path antivirusproduct
```

```sh
Get-CimInstance -Namespace root/SecurityCenter2 -ClassName AntivirusProduct
```

### Sysmon

Détecter si sysmon est disponible ou non sur la machine victime

```sh
Get-Process | Where-Object { $_.ProcessName -eq "Sysmon" }

Get-CimInstance win32_service -Filter "Description = 'System Monitor service'"

reg query HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WINEVT\Channels\Microsoft-Windows-Sysmon/Operational
```

Une fois sysmon détecté, nous pouvons essayer de trouver son fichier de configuration pour comprendre ce que les administrateurs système surveillent.

```sh
findstr /si '<ProcessCreate onmatch="exclude">' C:\tools\*
```

### EDR 

Nous pouvons utiliser des scripts pour énumérer les produits de sécurité au sein de la machine, tels que [Invoke-EDRChecker](https://github.com/PwnDexter/Invoke-EDRChecker) et [SharpEDRChecker](https://github.com/PwnDexter/SharpEDRChecker) .
